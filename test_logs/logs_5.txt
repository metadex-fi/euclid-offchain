[0m[32mTask[0m [0m[36mtest[0m deno test --allow-env --allow-read --allow-net tests
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/types.test.ts
[0m[38;5;245mrunning 1 test from ./tests/emulator.test.ts[0m
emulator ...
[0m[38;5;245m------- output -------[0m
trials left: 10
accounts: 10

trials left: 10 - iteration: 0 - block: 0

trials left: 10 - iteration: 1 - block: 1000
virtual: 1
weight: 64
jumpSize: 1
minAnchorPrice: 32
jumpLog: 0.6931471805599453
anchorLog: 0.030771658666753687
22.525505955544585
maxTicks: 6853458109946699
maxTicks_: 22
3
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 2284486036648899
maxTicks_: 3121657384082680
3
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
maxTicks: 761495345549633
maxTicks_: 183845919309941
3
attempting Opening...
virtual: 1
weight: 64
jumpSize: 1
minAnchorPrice: 32
jumpLog: 0.6931471805599453
anchorLog: 0.030771658666753687
22.525505955544585
virtual: 1
weight: 64
jumpSize: 1
minAnchorPrice: 32
jumpLog: 0.6931471805599453
anchorLog: 0.030771658666753687
22.525505955544585
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
virtual: 7172875055047577
weight: 1
jumpSize: 24
minAnchorPrice: 6885960052845673
jumpLog: 0.0408219945202552
anchorLog: 2.2204460492503128e-16
183845919309941.78
Opening pool with 27 dirac utxos and 1 param utxos
splitting opening
splitting pool
Opening pool with 13 dirac utxos and 1 param utxos
Opening pool with 14 dirac utxos and 0 param utxos
catching Insufficient input in transaction in finalizeTx() after splitting
failed: 1
Opening pool with 14 dirac utxos and 0 param utxos

trials left: 10 - iteration: 2 - block: 1002
virtual: 2
weight: 51
jumpSize: 100
minAnchorPrice: 100
jumpLog: 0.009950330853168092
anchorLog: 0.009950330853168092
1
maxTicks: 1
maxTicks_: 1
1
virtual: 9007199254740991
weight: 1
jumpSize: 37
minAnchorPrice: 8770167695405701
jumpLog: 0.026668247082161273
anchorLog: 2.2204460492503128e-16
120103107621845.84
maxTicks: 1
maxTicks_: 120103107621845
1
virtual: 1
weight: 81
jumpSize: 1
minAnchorPrice: 40
jumpLog: 0.6931471805599453
anchorLog: 0.024692612590371414
28.071034525938728
maxTicks: 1
maxTicks_: 28
1
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 3 - block: 1612
virtual: 7789046972231593
weight: 1
jumpSize: 1
minAnchorPrice: 3894523486115796
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 1
maxTicks_: 3121657384082680
1
virtual: 4209337755793890
weight: 2
jumpSize: 34
minAnchorPrice: 8178141925542414
jumpLog: 0.028987536873252187
anchorLog: 2.2204460492503128e-16
130548260260767.08
maxTicks: 1
maxTicks_: 130548260260767
1
virtual: 2
weight: 51
jumpSize: 100
minAnchorPrice: 100
jumpLog: 0.009950330853168092
anchorLog: 0.009950330853168092
1
maxTicks: 1
maxTicks_: 1
1
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 4 - block: 1613
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
subSwap: 3968503 sold
valueEquation: 
        addedBuyingA0  60269647193267031244800 > 
        addedSellingA0 22518000236750170457382
returning corruptBoughtAmnt(true)
valueEquation: 
        addedBuyingA0  22518020654850616852480 > 
        addedSellingA0 22518000236750170457382
returning corruptBoughtAmnt(false)
attempting 2 corruptions...
attempting corruption 0...
compiling tx for Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0, 
   +     +  virtual: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 9007199254740991,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7172875055047577
   +     +  ], 
   +     +  weights: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 64,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 24
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 644a92946f66cc43e6eea85aa60c72bf2fe3ffd76de3d08d189413a34ab5bfe1),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: c1ab8dd11ac378c8466fbee3aad46395294e18c14152a25df3ca8ed1b2b7952c),
   +     +  anchorPrices: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 40,
   +     +  +  _: 5674179970822794,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7075932427368868
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2676510,
   +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 253831781849877
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9, 4Z8rf)
  boughtAmount: 2676510
  soldAmount:   3968503
  boughtSpot:   5674179970822794
  soldSpot:     22517998136852480
  (boughtA0:    60269647193267031244800)
  (soldA0:      22518000236750170457382)
  boughtExp:    0
  soldExp:      49
  spotPrice:    3.9685026299204993
  eff.Price:    1.4827155512215535
  maxBuying:    2676510
  (maxBuyingA0: 60269647193267031244800)
)
finalized corruption tx
extractable ADA: 159470
gainedA0: 34160701793632995801818
[0m[38;5;245m----- output end -----[0m
emulator ... [0m[31mFAILED[0m [0m[38;5;245m(2s)[0m
[0m[38;5;245mrunning 0 tests from ./tests/types.test.ts[0m

[0m[1m[37m[41m ERRORS [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m
[0m[1m[31merror[0m: Error: type 0 corruption succeeded: Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0, 
   +     +  virtual: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 9007199254740991,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7172875055047577
   +     +  ], 
   +     +  weights: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 64,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 24
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 644a92946f66cc43e6eea85aa60c72bf2fe3ffd76de3d08d189413a34ab5bfe1),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: c1ab8dd11ac378c8466fbee3aad46395294e18c14152a25df3ca8ed1b2b7952c),
   +     +  anchorPrices: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 40,
   +     +  +  _: 5674179970822794,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7075932427368868
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2676510,
   +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 253831781849877
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9, 4Z8rf)
  boughtAmount: 1000000
  soldAmount:   3968503
  boughtSpot:   5674179970822794
  soldSpot:     22517998136852480
  (boughtA0:    22517998136852480000000)
  (soldA0:      22518000236750170457382)
  boughtExp:    0
  soldExp:      49
  spotPrice:    3.9685026299204993
  eff.Price:    3.968503
  maxBuying:    2676510
  (maxBuyingA0: 60269647193267031244800)
)
~~~>
Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0, 
   +     +  virtual: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 9007199254740991,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7172875055047577
   +     +  ], 
   +     +  weights: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 64,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 1,
   +     +  +  _: 1,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 24
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 8a233fd5d109258b9012f241fedc8ade22a8565a4c35de7c20b8f3a0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 644a92946f66cc43e6eea85aa60c72bf2fe3ffd76de3d08d189413a34ab5bfe1),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: c1ab8dd11ac378c8466fbee3aad46395294e18c14152a25df3ca8ed1b2b7952c),
   +     +  anchorPrices: +[
   +     +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 40,
   +     +  +  _: 5674179970822794,
   +     +  +  4db6f9c6a60e1ff1330cb842906da081d64ae8af9242e0bc2260b329_3lXZEPY8GGNR9MJS39SOhUJaWtXgHIVw: 7075932427368868
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2676510,
   +  +  580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9_4Z8rf: 253831781849877
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(580996ec5403f5b2dc46cd3a529dc8a8c07db0cc3decb1bfa86a9ba9, 4Z8rf)
  boughtAmount: 2676510
  soldAmount:   3968503
  boughtSpot:   5674179970822794
  soldSpot:     22517998136852480
  (boughtA0:    60269647193267031244800)
  (soldA0:      22518000236750170457382)
  boughtExp:    0
  soldExp:      49
  spotPrice:    3.9685026299204993
  eff.Price:    1.4827155512215535
  maxBuying:    2676510
  (maxBuyingA0: 60269647193267031244800)
)
                  throw new Error(`type ${t} corruption succeeded: ${swapping.show()}\n~~~>\n${c.show()}`);
[0m[31m                        ^[0m
    at [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m124[0m:[0m[33m25[0m
    at async [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m60[0m:[0m[33m24[0m

[0m[1m[37m[41m FAILURES [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m

[0m[31mFAILED[0m | 0 passed | 1 failed [0m[38;5;245m(3s)[0m

[0m[1m[31merror[0m: Test failed
