[0m[32mTask[0m [0m[36mtest[0m deno test --allow-env --allow-read --allow-net tests
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/types.test.ts
[0m[38;5;245mrunning 1 test from ./tests/emulator.test.ts[0m
emulator ...
[0m[38;5;245m------- output -------[0m
trials left: 10
accounts: 1

trials left: 10 - iteration: 0 - block: 0

trials left: 10 - iteration: 1 - block: 426

trials left: 10 - iteration: 2 - block: 1426

trials left: 10 - iteration: 3 - block: 1427

trials left: 10 - iteration: 4 - block: 2427

trials left: 10 - iteration: 5 - block: 3427

trials left: 10 - iteration: 6 - block: 3591

trials left: 10 - iteration: 7 - block: 4133

trials left: 10 - iteration: 8 - block: 4134

trials left: 10 - iteration: 9 - block: 4135

trials left: 10 - iteration: 10 - block: 5135

trials left: 10 - iteration: 11 - block: 6135

trials left: 10 - iteration: 12 - block: 6526

trials left: 10 - iteration: 13 - block: 6527

trials left: 10 - iteration: 14 - block: 7527

trials left: 10 - iteration: 15 - block: 8527

trials left: 10 - iteration: 16 - block: 9527

trials left: 10 - iteration: 17 - block: 9528

trials left: 10 - iteration: 18 - block: 10450

trials left: 10 - iteration: 19 - block: 10451
traces.length: 0
trials left: 10
accounts: 1

trials left: 10 - iteration: 0 - block: 0
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 1569922623411164
maxTicks_: 3121657384082680
3
virtual: 9007199254740991
weight: 1
jumpSize: 88
minAnchorPrice: 8905994768732665
jumpLog: 0.011299555253933466
anchorLog: 2.2204460492503128e-16
50888672831067.09
maxTicks: 1569922623411164
maxTicks_: 50888672831067
3
attempting Opening...
virtual: 9007199254740991
weight: 1
jumpSize: 88
minAnchorPrice: 8905994768732665
jumpLog: 0.011299555253933466
anchorLog: 2.2204460492503128e-16
50888672831067.09
virtual: 9007199254740991
weight: 1
jumpSize: 88
minAnchorPrice: 8905994768732665
jumpLog: 0.011299555253933466
anchorLog: 2.2204460492503128e-16
50888672831067.09
Opening pool with 3 dirac utxos and 1 param utxos

trials left: 10 - iteration: 1 - block: 673
attempting Closing...

trials left: 10 - iteration: 2 - block: 868
virtual: 1
weight: 49
jumpSize: 48
minAnchorPrice: 48
jumpLog: 0.02061928720273561
anchorLog: 0.02061928720273561
1
maxTicks: 399091660605745
maxTicks_: 1
1
virtual: 2584921127779271
weight: 2
jumpSize: 100
minAnchorPrice: 5118655698572813
jumpLog: 0.009950330853168092
anchorLog: 2.2204460492503128e-16
44812306322540.98
maxTicks: 399091660605745
maxTicks_: 44812306322540
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 3 - block: 869
virtual: 2
weight: 51
jumpSize: 100
minAnchorPrice: 100
jumpLog: 0.009950330853168092
anchorLog: 0.009950330853168092
1
maxTicks: 493396736725662
maxTicks_: 1
1
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 493396736725662
maxTicks_: 3121657384082680
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 4 - block: 870
attempting Closing...

trials left: 10 - iteration: 5 - block: 1163
attempting Closing...

trials left: 10 - iteration: 6 - block: 2163
virtual: 2
weight: 63
jumpSize: 100
minAnchorPrice: 124
jumpLog: 0.009950330853168092
anchorLog: 0.008032171697264253
1.2388095309961018
maxTicks: 1209711839975391
maxTicks_: 1
1
virtual: 9007199254740991
weight: 1
jumpSize: 78
minAnchorPrice: 8893184074301231
jumpLog: 0.012739025777429712
anchorLog: 2.2204460492503128e-16
57371471744295.6
maxTicks: 1209711839975391
maxTicks_: 57371471744295
3
attempting Opening...
virtual: 9007199254740991
weight: 1
jumpSize: 78
minAnchorPrice: 8893184074301231
jumpLog: 0.012739025777429712
anchorLog: 2.2204460492503128e-16
57371471744295.6
virtual: 9007199254740991
weight: 1
jumpSize: 78
minAnchorPrice: 8893184074301231
jumpLog: 0.012739025777429712
anchorLog: 2.2204460492503128e-16
57371471744295.6
Opening pool with 3 dirac utxos and 1 param utxos

trials left: 10 - iteration: 7 - block: 2449
attempting Closing...

trials left: 10 - iteration: 8 - block: 3090
virtual: 2
weight: 51
jumpSize: 100
minAnchorPrice: 100
jumpLog: 0.009950330853168092
anchorLog: 0.009950330853168092
1
maxTicks: 441487546142574
maxTicks_: 1
1
virtual: 9007199254740991
weight: 1
jumpSize: 1
minAnchorPrice: 4503599627370495
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 441487546142574
maxTicks_: 3121657384082680
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 9 - block: 4090
virtual: 1
weight: 63
jumpSize: 62
minAnchorPrice: 62
jumpLog: 0.01600034134644112
anchorLog: 0.01600034134644112
1
maxTicks: 928856443219576
maxTicks_: 1
1
virtual: 1
weight: 72
jumpSize: 71
minAnchorPrice: 71
jumpLog: 0.01398624197473987
anchorLog: 0.01398624197473987
1
maxTicks: 928856443219576
maxTicks_: 1
1
virtual: 6388060217011418
weight: 1
jumpSize: 1
minAnchorPrice: 3194030108505709
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 928856443219576
maxTicks_: 3121657384082680
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 10 - block: 4091
virtual: 445090354443992
weight: 11
jumpSize: 75
minAnchorPrice: 4831572926530176
jumpLog: 0.013245226750020723
anchorLog: 2.2204460492503128e-16
59651198255831.06
maxTicks: 167245679191058
maxTicks_: 59651198255831
3
virtual: 4466874358131200
weight: 2
jumpSize: 12
minAnchorPrice: 8246537276549907
jumpLog: 0.08004270767353636
anchorLog: 2.2204460492503128e-16
360480308452263.94
maxTicks: 167245679191058
maxTicks_: 360480308452263
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 11 - block: 5091
Swapping.boundary()
Swapping.boundary()
subSwap: 24466501 sold
attempting 0 corruptions...
attempting Swapping...
compiling tx for Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0, 
   +     +  virtual: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 1,
   +     +  +  0e92e6288ecf731dc82b4c4b7bd9d43d8b9d43ee77295c487159ed08_u7otXlw8tWp: 1,
   +     +  +  _: 6388060217011418
   +     +  ], 
   +     +  weights: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 63,
   +     +  +  0e92e6288ecf731dc82b4c4b7bd9d43d8b9d43ee77295c487159ed08_u7otXlw8tWp: 72,
   +     +  +  _: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 62,
   +     +  +  0e92e6288ecf731dc82b4c4b7bd9d43d8b9d43ee77295c487159ed08_u7otXlw8tWp: 71,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: be30c2040ff650820f6fd7fd8e66c1b58dd6367837733226b90f99f1d5ef7263),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: d1362cd4246b4cd1129ab7cc7c4fe7eb0ebbf3398f95c358eb403a8ba170e6d2),
   +     +  anchorPrices: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 62,
   +     +  +  0e92e6288ecf731dc82b4c4b7bd9d43d8b9d43ee77295c487159ed08_u7otXlw8tWp: 71,
   +     +  +  _: 3194030108505709
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2629100,
   +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 928856443219576
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c, UpV4e8fqJXsssI)
  boughtAmount: 2629100
  soldAmount:   24466501
  boughtSpot:   6388060217011418
  soldSpot:     59447521576686436
  (boughtA0:    156293478977266308887600)
  (soldA0:      156293481687570075508418)
  boughtExp:    1
  soldExp:      2156
  spotPrice:    9.306036505162796
  eff.Price:    9.30603666653988
  maxBuying:    2629100
  (maxBuyingA0: 156293478977266308887600)
)

trials left: 10 - iteration: 12 - block: 6091
attempting Closing...

trials left: 10 - iteration: 13 - block: 7091
Swapping.boundary()
Swapping.boundary()
subSwap: 5225761 sold
valueEquation: 
        addedBuyingA0  55126456871920937409600 > 
        addedSellingA0 47069461577455275902400
returning corruptBoughtAmnt(true)
valueEquation: 
        addedBuyingA0  47069481775023434159280 > 
        addedSellingA0 47069461577455275902400
returning corruptBoughtAmnt(false)
attempting 2 corruptions...
attempting corruption 0...
compiling tx for Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0, 
   +     +  virtual: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 2,
   +     +  +  _: 9007199254740991
   +     +  ], 
   +     +  weights: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 51,
   +     +  +  _: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 02c5938eec9dc521a9b7ddc59897193c9285f45f11dbe4a0e28a04e95b1850f0),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 61ae4190260b800a56eacf0aedcf8fe38fe55ed1220b989b370659d5ea6f6cb0),
   +     +  anchorPrices: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 4503599627370495
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2430840,
   +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 441487546142574
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c, UpV4e8fqJXsssI)
  boughtAmount: 2430840
  soldAmount:   5225760
  boughtSpot:   9007199254740990
  soldSpot:     22677945431176440
  (boughtA0:    55126456871920937409600)
  (soldA0:      47069461577455275902400)
  boughtExp:    1
  soldExp:      3322
  spotPrice:    2.517757716888496
  eff.Price:    2.149775386286222
  maxBuying:    2430840
  (maxBuyingA0: 55126456871920937409600)
)
finalized corruption tx
extractable ADA: 159470
gainedA0: 4440543336555954620400
[0m[38;5;245m----- output end -----[0m
emulator ... [0m[31mFAILED[0m [0m[38;5;245m(1s)[0m
[0m[38;5;245mrunning 0 tests from ./tests/types.test.ts[0m

[0m[1m[37m[41m ERRORS [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m
[0m[1m[31merror[0m: Error: type 0 corruption succeeded: Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0, 
   +     +  virtual: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 2,
   +     +  +  _: 9007199254740991
   +     +  ], 
   +     +  weights: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 51,
   +     +  +  _: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 02c5938eec9dc521a9b7ddc59897193c9285f45f11dbe4a0e28a04e95b1850f0),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 61ae4190260b800a56eacf0aedcf8fe38fe55ed1220b989b370659d5ea6f6cb0),
   +     +  anchorPrices: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 4503599627370495
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2430840,
   +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 441487546142574
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c, UpV4e8fqJXsssI)
  boughtAmount: 2075561
  soldAmount:   5225760
  boughtSpot:   9007199254740990
  soldSpot:     22677945431176440
  (boughtA0:    47069459097078002982840)
  (soldA0:      47069461577455275902400)
  boughtExp:    1
  soldExp:      3322
  spotPrice:    2.517757716888496
  eff.Price:    2.517757849564527
  maxBuying:    2430840
  (maxBuyingA0: 55126456871920937409600)
)
~~~>
Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0, 
   +     +  virtual: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 2,
   +     +  +  _: 9007199254740991
   +     +  ], 
   +     +  weights: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 51,
   +     +  +  _: 1
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 428b529be97a92092d2a275c107f3ffe0843c22cb02415eda39179f0,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 02c5938eec9dc521a9b7ddc59897193c9285f45f11dbe4a0e28a04e95b1850f0),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 61ae4190260b800a56eacf0aedcf8fe38fe55ed1220b989b370659d5ea6f6cb0),
   +     +  anchorPrices: +[
   +     +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 100,
   +     +  +  _: 4503599627370495
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2430840,
   +  +  68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c_UpV4e8fqJXsssI: 441487546142574
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(68679e8211a9974d504a70e7ab30e86322c9c637a9ae903675063e0c, UpV4e8fqJXsssI)
  boughtAmount: 2430840
  soldAmount:   5225760
  boughtSpot:   9007199254740990
  soldSpot:     22677945431176440
  (boughtA0:    55126456871920937409600)
  (soldA0:      47069461577455275902400)
  boughtExp:    1
  soldExp:      3322
  spotPrice:    2.517757716888496
  eff.Price:    2.149775386286222
  maxBuying:    2430840
  (maxBuyingA0: 55126456871920937409600)
)
                  throw new Error(`type ${t} corruption succeeded: ${swapping.show()}\n~~~>\n${c.show()}`);
[0m[31m                        ^[0m
    at [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m124[0m:[0m[33m25[0m
    at async [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m60[0m:[0m[33m24[0m

[0m[1m[37m[41m FAILURES [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m

[0m[31mFAILED[0m | 0 passed | 1 failed [0m[38;5;245m(3s)[0m

[0m[1m[31merror[0m: Test failed
