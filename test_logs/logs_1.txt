[0m[32mTask[0m [0m[36mtest[0m deno test --allow-env --allow-read --allow-net tests
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts
[0m[32mCheck[0m file:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/types.test.ts
[0m[38;5;245mrunning 1 test from ./tests/emulator.test.ts[0m
emulator ...
[0m[38;5;245m------- output -------[0m
trials left: 10
accounts: 10

trials left: 10 - iteration: 0 - block: 0
virtual: 128296958864973
weight: 70
jumpSize: 100
minAnchorPrice: 8891868436186247
jumpLog: 0.009950330853168092
anchorLog: 2.2204460492503128e-16
44812306322540.98
maxTicks: 1
maxTicks_: 44812306322540
1
virtual: 2
weight: 51
jumpSize: 100
minAnchorPrice: 100
jumpLog: 0.009950330853168092
anchorLog: 0.009950330853168092
1
maxTicks: 1
maxTicks_: 1
1
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 1 - block: 189
virtual: 7107658702911339
weight: 2
jumpSize: 1
minAnchorPrice: 7107658702911339
jumpLog: 0.6931471805599453
anchorLog: 2.2204460492503128e-16
3121657384082680
maxTicks: 8173965256762057
maxTicks_: 3121657384082680
3
virtual: 4476549282583432
weight: 1
jumpSize: 75
minAnchorPrice: 4417647318338913
jumpLog: 0.013245226750020723
anchorLog: 2.2204460492503128e-16
59651198255831.06
maxTicks: 8173965256762057
maxTicks_: 59651198255831
3
attempting Opening...
Opening pool with 1 dirac utxos and 1 param utxos

trials left: 10 - iteration: 2 - block: 1189
virtual: 4591653903637428
weight: 1
jumpSize: 6
minAnchorPrice: 3935703345974938
jumpLog: 0.15415067982725836
anchorLog: 2.2204460492503128e-16
694232944228949.5
maxTicks: 6884139252533991
maxTicks_: 694232944228949
3
virtual: 1730676167151177
weight: 2
jumpSize: 100
minAnchorPrice: 3427081519111241
jumpLog: 0.009950330853168092
anchorLog: 2.2204460492503128e-16
44812306322540.98
maxTicks: 2294713084177997
maxTicks_: 44812306322540
3
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
maxTicks: 2294713084177997
maxTicks_: 35
3
attempting Opening...
virtual: 4591653903637428
weight: 1
jumpSize: 6
minAnchorPrice: 3935703345974938
jumpLog: 0.15415067982725836
anchorLog: 2.2204460492503128e-16
694232944228949.5
virtual: 4591653903637428
weight: 1
jumpSize: 6
minAnchorPrice: 3935703345974938
jumpLog: 0.15415067982725836
anchorLog: 2.2204460492503128e-16
694232944228949.5
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
virtual: 1
weight: 100
jumpSize: 1
minAnchorPrice: 50
jumpLog: 0.6931471805599453
anchorLog: 0.01980262729617973
35.0027887811465
Opening pool with 9 dirac utxos and 1 param utxos

trials left: 10 - iteration: 3 - block: 2189
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
Swapping.boundary()
subSwap: 40175460526868 sold
boughtAssetForSale (new): 
        buyingAmm  100 > 
        spotBuying 165675008
returning corruptBoughtAmnt(true)
valueEquation: 
        addedBuyingA0  6656072467663806231526 > 
        addedSellingA0 6656066217912819515392
returning corruptBoughtAmnt(false)
attempting 2 corruptions...
attempting corruption 0...
compiling tx for Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616, 
   +     +  virtual: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 4591653903637428,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 1730676167151177,
   +     +  +  _: 1
   +     +  ], 
   +     +  weights: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 1,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 2,
   +     +  +  _: 100
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 6,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 3d2228db9b2251045dfdaacaa7d432fc1e7dea63dfa0600617e2fdceb4541e49),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 6f799d7bea9cda91012c12ef88fe6bff62aeb631c0de02654bd2f09ebcc41ad5),
   +     +  anchorPrices: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 3935703345974938,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 3427081519111241,
   +     +  +  _: 79
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2917870,
   +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 764904361392665
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650, jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg)
  boughtAmount: 2917870
  soldAmount:   40175439242549
  boughtSpot:   165675008
  soldSpot:     6249751146617609
  (boughtA0:    18235961378181122772830)
  (soldA0:      6656066217912819515392)
  boughtExp:    21
  soldExp:      3
  spotPrice:    37722956.6611375
  eff.Price:    13768755.716515472
  maxBuying:    2917870
  (maxBuyingA0: 18235961378181122772830)
)
finalized corruption tx
extractable ADA: 159470
gainedA0: 10583247344917193150208
[0m[38;5;245m----- output end -----[0m
emulator ... [0m[31mFAILED[0m [0m[38;5;245m(963ms)[0m
[0m[38;5;245mrunning 0 tests from ./tests/types.test.ts[0m

[0m[1m[37m[41m ERRORS [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m
[0m[1m[31merror[0m: Error: type 0 corruption succeeded: Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616, 
   +     +  virtual: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 4591653903637428,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 1730676167151177,
   +     +  +  _: 1
   +     +  ], 
   +     +  weights: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 1,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 2,
   +     +  +  _: 100
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 6,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 3d2228db9b2251045dfdaacaa7d432fc1e7dea63dfa0600617e2fdceb4541e49),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 6f799d7bea9cda91012c12ef88fe6bff62aeb631c0de02654bd2f09ebcc41ad5),
   +     +  anchorPrices: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 3935703345974938,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 3427081519111241,
   +     +  +  _: 79
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2917870,
   +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 764904361392665
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650, jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg)
  boughtAmount: 1065013
  soldAmount:   40175439242549
  boughtSpot:   165675008
  soldSpot:     6249751146617609
  (boughtA0:    6656066217912659613917)
  (soldA0:      6656066217912819515392)
  boughtExp:    21
  soldExp:      3
  spotPrice:    37722956.6611375
  eff.Price:    37722956.66113841
  maxBuying:    2917870
  (maxBuyingA0: 18235961378181122772830)
)
~~~>
Swapping (
  paramUtxo: ParamUtxo (
     +  param: Param (
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616, 
   +     +  virtual: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 4591653903637428,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 1730676167151177,
   +     +  +  _: 1
   +     +  ], 
   +     +  weights: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 1,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 2,
   +     +  +  _: 100
   +     +  ]
   +     +  jumpSizes: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 6,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 100,
   +     +  +  _: 1
   +     +  ], 
   +     +  active: 1
   +     )
     )
  diracUtxo: DiracUtxo (
     +  dirac: Dirac(
   +     +  owner: 1438f70b972a528dd43b0ca66c18a6949dedebd0cba56afdd9499616,
   +     +  threadNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 3d2228db9b2251045dfdaacaa7d432fc1e7dea63dfa0600617e2fdceb4541e49),
   +     +  paramNFT: IdNFT (Currency(49a0b0e032416036152977ff1fac1aed683512166af02b36f2eb1851), Hash: 6f799d7bea9cda91012c12ef88fe6bff62aeb631c0de02654bd2f09ebcc41ad5),
   +     +  anchorPrices: +[
   +     +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 3935703345974938,
   +     +  +  ccd0c9e4db2934795c23f05619d44a8d625c7a8df14a9976d189de04_7pZoJX8hbNq0Sh1VAsEGTBn51AFUBh9M: 3427081519111241,
   +     +  +  _: 79
   +     +  ],
   +     ),
     +  balance: +[
   +  +  _: 2917870,
   +  +  712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650_jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg: 764904361392665
   +  ]
     )
  boughtAsset:  Asset(, )
  soldAsset:    Asset(712853fd10b85daa6f23e069ee52b7c97edea9cbac48355a50cd5650, jhcgp08gdlctGrKQ0YJRjrQPqwaqRzkg)
  boughtAmount: 2917870
  soldAmount:   40175439242549
  boughtSpot:   165675008
  soldSpot:     6249751146617609
  (boughtA0:    18235961378181122772830)
  (soldA0:      6656066217912819515392)
  boughtExp:    21
  soldExp:      3
  spotPrice:    37722956.6611375
  eff.Price:    13768755.716515472
  maxBuying:    2917870
  (maxBuyingA0: 18235961378181122772830)
)
                  throw new Error(`type ${t} corruption succeeded: ${swapping.show()}\n~~~>\n${c.show()}`);
[0m[31m                        ^[0m
    at [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m124[0m:[0m[33m25[0m
    at async [0m[36mfile:///Users/ChrisHiatt/Projects/adaswap/vasil_2022Q3/euclid-offchain/tests/emulator.test.ts[0m:[0m[33m60[0m:[0m[33m24[0m

[0m[1m[37m[41m FAILURES [0m

emulator [0m[38;5;245m=> ./tests/emulator.test.ts:19:6[0m

[0m[31mFAILED[0m | 0 passed | 1 failed [0m[38;5;245m(3s)[0m

[0m[1m[31merror[0m: Test failed
